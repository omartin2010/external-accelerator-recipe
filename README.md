## Accelerators Usage Samples 
In this repo, you will (eventually) find (several) examples of using Google Cloud's accelerators (GPU & TPU) using different provisionning methods (including spot, on demand, reservations, GKE Flex, and GKE Calendar), and also using different orchestrators (Slurm + GKE primarily).

### Recipes
1. [`dws-flex-a3m-gke-toolkit.sh`](./dws-flex-a3m-gke-toolkit.sh) : This recipe shows how to deploy a GKE cluster using `a3-megagpu-8g` instances using a DWS Flex Nodepool, and leveraging the [Cluster Toolkit](https://github.com/GoogleCloudPlatform/cluster-toolkit/tree/main) for deployment. The script is NOT meant to be run all in one go, but run commands separately, until you have your basic workload tested (NCCL benchmarks). Then you can create manifests and include the labels for DWS Flex.

2. [`dws-flex-a3m-slurm-toolkit.sh`](./dws-flex-a3m-slurm-toolkit.sh) : This recipe shows how to deploy a Slurm cluster the Cluster Toolkit and a Slurm partition using `a3-megagpu-8g` nodes scheduled using Dynamic Workload Scheduler (DWS) Flex Mode. The deployment is split into 3 steps, similar to how it is demonstrated on the [official Google documentation](https://cloud.google.com/cluster-toolkit/docs/deploy/deploy-a3-mega-cluster) page. Flags were added to the creation of the DWS-enabled partition, and this is why the yaml blueprints used in this recipe are in this repository (but mostly identical to the one in the official [Cluster Toolkit repository](https://github.com/GoogleCloudPlatform/cluster-toolkit/tree/main) with the differences being around using DWS Flex.